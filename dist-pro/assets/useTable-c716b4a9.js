import{k as t,r as a,K as e,a as s,S as n,G as l,M as o}from"./index-52ef42af.js";import{E as c}from"./el-message-box-0af6f607.js";import"./el-button-650eeff8.js";import"./el-input-77e90b76.js";import"./el-overlay-4d248072.js";const{t:i}=t(),u=t=>{const{immediate:u=!0}=t,m=a(!1),r=a(1),d=a(10),g=a(0),p=a([]);e((()=>r.value),(()=>{w.getList()})),e((()=>d.value),(()=>{1===s(r)||(r.value=1),w.getList()})),n((()=>{u&&w.getList()}));const y=a(),v=a(),f=async()=>{await o();const t=s(y);return t},w={getList:async()=>{m.value=!0;try{const a=await(null==t?void 0:t.fetchDataApi());a&&(p.value=a.list,g.value=a.total||0)}catch(a){}finally{m.value=!1}},setProps:async(t={})=>{const a=await f();null==a||a.setProps(t)},setColumn:async t=>{const a=await f();null==a||a.setColumn(t)},addColumn:async(t,a)=>{const e=await f();null==e||e.addColumn(t,a)},delColumn:async t=>{const a=await f();null==a||a.delColumn(t)},getElTableExpose:async()=>(await f(),s(v)),refresh:()=>{w.getList()},delList:async a=>{const{fetchDelApi:e}=t;e&&c.confirm(i("common.delMessage"),i("common.delWarning"),{confirmButtonText:i("common.delOk"),cancelButtonText:i("common.delCancel"),type:"warning"}).then((async()=>{if(await e()){l.success(i("common.delSuccess"));const t=(s(g)%s(d)===a||1===s(d))&&s(r)>1?s(r)-1:s(r);r.value=t,w.getList()}}))}};return{tableRegister:(t,a)=>{y.value=t,v.value=s(a)},tableMethods:w,tableState:{currentPage:r,pageSize:d,total:g,dataList:p,loading:m}}};export{u};
